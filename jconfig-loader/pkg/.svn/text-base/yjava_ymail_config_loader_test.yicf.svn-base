#!/usr/local/bin/perl

print <<'EOF';
PRODUCT_NAME = $(POM_ARTIFACT_ID)_test
LIBEXEC = /home/y/libexec/mail
SRCDIRS = .
SHORT_DESC = $(POM_DESCRIPTION)
CUSTODIAN = "$(POM_MAILINGLIST_0_NAME)@yahoo-inc.com $(POM_URL)"
#YMAVEN_TRANSITIVE_ENABLED

TEMP_VERSION = $(POM_VERSION)
VERSION = `echo $TEMP_VERSION|awk -F"-SNAPSHOT" '{print$1}'`

EOF

if($ENV{"BUILDTYPE"} eq "release") {
print <<'EOF';
LONG_DESC = `$(LIBEXEC)/ymPkgDescGen.pl -package_name $PRODUCT_NAME -package_version $VERSION -srcdir $SRCDIRS -latest 2> /dev/null`
EOF
}else{
print <<'EOF';
LONG_DESC = "$(SHORT_DESC) $(VERSION)"
EOF
}

print <<'EOF';

PERM = 444
OWNER = nobody
GROUP = wheel
PACKAGE_OS_SPECIFIC = no

YINST requires pkg yjava_jdk 1.6 *
YINST requires pkg yjava_ymail_config_loader *

YINST set autostart on

YINST bug-product $(POM_BUG_PRODUCT)
YINST bug-component $(POM_BUG_COMPONENT)

#f - - - lib/jars/$(PRODUCT_NAME)-$(VERSION).jar target/$(PRODUCT_NAME).jar
#f - - - lib/jars/$(PRODUCT_NAME)-$(VERSION).pom pom.xml
#symlink - - - lib/jars/$(PRODUCT_NAME).jar $(PRODUCT_NAME)-$(VERSION).jar
#symlink - - - lib/jars/$(PRODUCT_NAME).pom $(PRODUCT_NAME)-$(VERSION).pom

# This links the versioned JAR to an unversioned name.
#symlink - - - libexec/$(PRODUCT_NAME)/lib/$(PRODUCT_NAME).jar $(ROOT)/lib/jars/$(PRODUCT_NAME)-$(VERSION).jar

# Copy jars we depend on. 
find 0755 - - libexec/$(PRODUCT_NAME)/lib/ target/libs/ -name "*.jar" -type f

f - - - share/$(PRODUCT_NAME)/$(PRODUCT_NAME).pom pom.xml

# to run config Loader
f 0755 - - libexec/$(PRODUCT_NAME)/bin/configLoaderIntegrationTests src/integration/bin/configLoaderIntegrationTests

dir 755 - - conf/ymailAutoConf
dir 755 - - logs/$(PRODUCT_NAME)

#config file for integration test for config loader. Here conf/ymailAutoConf/ymail.conf is default path set in ConfigLoaderCofig
f 0755 - - conf/ymailAutoConf/ymail.conf src/integration/resources/ymail.conf


EOF

if($ENV{"BUILDTYPE"} eq "release") {
print <<'EOF';
f - - - var/share/package-manifests/$(PRODUCT_NAME)/yinst-manifest.xml target/yjava_maven_plugins_lint/manifest2.xml
#f - - - lib/jars/$(PRODUCT_NAME)-site.jar target/$(PRODUCT_NAME)-site.jar
#f - - - lib/jars/$(PRODUCT_NAME)-javadoc.jar target/$(PRODUCT_NAME)-javadoc.jar
#f - - - lib/jars/$(PRODUCT_NAME)-sources.jar target/$(PRODUCT_NAME)-sources.jar
EOF
}
